<html>
<head>
	<title>My NFT</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<style>
		body {
			font-family: Arial, Helvetica, sans-serif;
		}
	</style>
</head>
<body>
<h2>Your Metamask Address: <span id="your_meta_acc">connecting to Metamask...</span></h2>
<h2>Your Metamask Network: <span id="your_meta_net">connecting to Metamask...</span></h2>

<hr/>

<h2>Contract Address: <span id="contract_address"></span></h2>
<h2>Contract Name and Symbol: <span id="contract_info">loading...</span></h2>
<h2>Contract Owner: <span id="contract_owner">loading...</span></h2>

<hr/>

<h2>Mint Miumicream NFT</h2>

<div style="margin: 10px 0px;">
	<button id="btn_mint">MINT NFT</button>
</div>

<div style="margin: 10px 0px;">
	<input type="text" id="inp_amount_mint" value="2" placeholder="Amount" />
	<button id="btn_amount_mint">MINT NFT</button>
</div>

<div style="margin: 10px 0px;">
	<input type="text" id="inp_recipient" value="0x8F6e30934a49Ed30Bb8BeFEb978B068D6f15e859" placeholder="recipient address" />
	<button id="btn_change_recipient">Change Address Recipient</button>
</div>

<div style="margin: 10px 0px;">
	<input type="text" id="inp_add_whitelist" value="0x8F6e30934a49Ed30Bb8BeFEb978B068D6f15e859" placeholder="whitelist address" />
	<button id="btn_add_whitelist">ADD WHITELIST</button>
</div>

<div style="margin: 10px 0px;">
	<input type="text" id="inp_remove_whitelist" value="0x8F6e30934a49Ed30Bb8BeFEb978B068D6f15e859" placeholder="whitelist address" />
	<button id="btn_remove_whitelist">REMOVE WHITELIST</button>
</div>

<div style="margin: 10px 0px;">
	<button id="btn_get_max_supply">GET MAX SUPPLY</button>
</div>

<div style="margin: 10px 0px;">
	<button id="btn_get_price">GET PRICE</button>
</div>

<div style="margin: 10px 0px;">
	<button id="btn_get_price_whitelist">GET PRICE WHITELIST</button>
</div>

<div style="margin: 10px 0px;">
	<button id="btn_set_hold">HOLD MINT</button>
	<button id="btn_set_unhold">UNHOLD MINT</button>
</div>

<div style="margin: 10px 0px;">
	<input type="text" id="inp_address" value="0x8F6e30934a49Ed30Bb8BeFEb978B068D6f15e859" placeholder="address" />
	<button id="btn_get_nft">Get NFT</button>

	<div id="list-nft"></div>
</div>

<a href="" id="etherscan_ahref" target="_blank"></a>

<script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js" type="application/javascript"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
// SET PARAMS HERE:
let myContractABI = [
	{
		"inputs": [],
		"stateMutability": "payable",
		"type": "constructor"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "sender",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			},
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			}
		],
		"name": "ERC721IncorrectOwner",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "operator",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "ERC721InsufficientApproval",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "approver",
				"type": "address"
			}
		],
		"name": "ERC721InvalidApprover",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "operator",
				"type": "address"
			}
		],
		"name": "ERC721InvalidOperator",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			}
		],
		"name": "ERC721InvalidOwner",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "receiver",
				"type": "address"
			}
		],
		"name": "ERC721InvalidReceiver",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "sender",
				"type": "address"
			}
		],
		"name": "ERC721InvalidSender",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "ERC721NonexistentToken",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			}
		],
		"name": "OwnableInvalidOwner",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "account",
				"type": "address"
			}
		],
		"name": "OwnableUnauthorizedAccount",
		"type": "error"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "address",
				"name": "newAddressReceiver",
				"type": "address"
			}
		],
		"name": "AddressReceiverChanged",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "approved",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "Approval",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "operator",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "bool",
				"name": "approved",
				"type": "bool"
			}
		],
		"name": "ApprovalForAll",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "_fromTokenId",
				"type": "uint256"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "_toTokenId",
				"type": "uint256"
			}
		],
		"name": "BatchMetadataUpdate",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "EtherWithdrawn",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "GetEther",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "newMaxMintOnTime",
				"type": "uint256"
			}
		],
		"name": "MaxMintOnTimeChanged",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "newMaxMintPerWallet",
				"type": "uint256"
			}
		],
		"name": "MaxMintPerWalletChanged",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "newMaxSupply",
				"type": "uint256"
			}
		],
		"name": "MaxSupplyChanged",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "_tokenId",
				"type": "uint256"
			}
		],
		"name": "MetadataUpdate",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "senderAddress",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "uint256",
				"name": "newItemId",
				"type": "uint256"
			}
		],
		"name": "NFTMinted",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "previousOwner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "OwnershipTransferred",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "newPrice",
				"type": "uint256"
			}
		],
		"name": "PriceChanged",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "Transfer",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address[]",
				"name": "toAddAddresses",
				"type": "address[]"
			}
		],
		"name": "addToWhitelist",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "allowMintPublic",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "allowMintWhitelist",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "approve",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			}
		],
		"name": "balanceOf",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "baseUri",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "receiver",
				"type": "address"
			}
		],
		"name": "changeAddressReceiver",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "newBaseJsonUrl",
				"type": "string"
			}
		],
		"name": "changeBaseJsonUrl",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "newMaxMintOnTime",
				"type": "uint256"
			}
		],
		"name": "changeMaxMintOnTime",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "newMaxMintPerWallet",
				"type": "uint256"
			}
		],
		"name": "changeMaxMintPerWallet",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "newMaxSupply",
				"type": "uint256"
			}
		],
		"name": "changeMaxSupply",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "newPrice",
				"type": "uint256"
			}
		],
		"name": "changePrice",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "newPriceWhitelist",
				"type": "uint256"
			}
		],
		"name": "changePriceWhitelist",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "getApproved",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getMaxMintOnTime",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getMaxMintPerWallet",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getPrice",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getPriceWhitelist",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getStatusHoldMintPublic",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getStatusHoldMintWhitelist",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "walletAddress",
				"type": "address"
			}
		],
		"name": "getTokenIdsByAddress",
		"outputs": [
			{
				"internalType": "uint256[]",
				"name": "",
				"type": "uint256[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "holdMintPublic",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "holdMintWhitelist",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "operator",
				"type": "address"
			}
		],
		"name": "isApprovedForAll",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "walletAddress",
				"type": "address"
			}
		],
		"name": "isWhitelistAddress",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "mint",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "minted",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "multiMint",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "name",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "ownerOf",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address[]",
				"name": "toRemoveAddresses",
				"type": "address[]"
			}
		],
		"name": "removeFromWhitelist",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "renounceOwnership",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "safeTransferFrom",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			},
			{
				"internalType": "bytes",
				"name": "data",
				"type": "bytes"
			}
		],
		"name": "safeTransferFrom",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "operator",
				"type": "address"
			},
			{
				"internalType": "bool",
				"name": "approved",
				"type": "bool"
			}
		],
		"name": "setApprovalForAll",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "bytes4",
				"name": "interfaceId",
				"type": "bytes4"
			}
		],
		"name": "supportsInterface",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "symbol",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "tokenURI",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "totalSupply",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "transferFrom",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "transferOwnership",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	}
];
let myContractAddress = '0x2AF2e621DFa5dB8a83b4841EC86eEB662f4afE34';

// ===========================================

// html stuff
let $txtMetaAcc = document.getElementById('your_meta_acc');
let $txtMetaNet = document.getElementById('your_meta_net');

let $txtContractAddress = document.getElementById('contract_address');
let $txtContractOwner = document.getElementById('contract_owner');
let $txtContractInfo = document.getElementById('contract_info');
$txtContractAddress.innerHTML = myContractAddress;

let $inpReceipient = document.getElementById('inp_recipient');
let $inpUrl = document.getElementById('inp_url');
let $inpAddress = document.getElementById('inp_address');
let $inpAddWhitelist = document.getElementById('inp_add_whitelist');
let $inpRemoveWhitelist = document.getElementById('inp_remove_whitelist');
let $inpAmountMint = document.getElementById('inp_amount_mint');
let $btnMint = document.getElementById('btn_mint');
let $btnAmountMint = document.getElementById('btn_amount_mint');
let $btnAddWhitelist = document.getElementById('btn_add_whitelist');
let $btnRemoveWhitelist = document.getElementById('btn_remove_whitelist');
let $btnChangeRecipient = document.getElementById('btn_change_recipient');
let $btnGetNft = document.getElementById('btn_get_nft');
let $btnSetHold = document.getElementById('btn_set_hold');
let $btnSetUnhold = document.getElementById('btn_set_unhold');
let $btnGetMaxSupply = document.getElementById('btn_get_max_supply');
let $btnGetPrice = document.getElementById('btn_get_price');
let $btnGetPriceWhitelist = document.getElementById('btn_get_price_whitelist');
let $listNft = document.getElementById('list-nft');
let $ahref = document.getElementById('etherscan_ahref');

let etherscanBaseUrl = 'https://sepolia.etherscan.io/tx/';

// Create Polygon Mumbai Testnet Web3Provider
const metamaskProvider = new ethers.providers.Web3Provider(window.ethereum);

// Prepare ETH Contract for later use
const ethContract = new ethers.Contract(myContractAddress, myContractABI, metamaskProvider);

init();
async function init() {
	try {
		const holdMint = await contractWithSigner.getStatusHold();
	
		if((holdMint ?? 0)){
			$btnSetUnhold.style.display = 'block';
			$btnSetHold.style.display = 'none';
		} else {
			$btnSetUnhold.style.display = 'none';
			$btnSetHold.style.display = 'block';
		}
	} catch (error) {
		const holdMint = 0;
		$btnSetUnhold.style.display = 'none';
		$btnSetHold.style.display = 'block';
	}
}

async function connectWithMetamask() {
    const account = await metamaskProvider.send("eth_requestAccounts", []);
    const network = await metamaskProvider.getNetwork();
    $txtMetaAcc.innerHTML = account;
    $txtMetaNet.innerHTML = network.name + ' (' + network.chainId + ')';
}

async function connectWithContract() {
	$txtContractOwner.innerHTML = 'connecting...';
	$txtContractOwner.innerHTML = await ethContract.owner();
	$txtContractInfo.innerHTML = await ethContract.name() + ' / ' + await ethContract.symbol();
	console.log($txtContractOwner.innerHTML + ' ' + $txtContractInfo.innerHTML);
}

async function performMintNft() {
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	const valueInWei = await contractWithSigner.getPrice();

	try {
		let transaction = await contractWithSigner.mint({
			value: valueInWei,
		});
		
		$ahref.innerHTML = 'View Etherscan: ' + etherscanBaseUrl + transaction.hash;
		$ahref.href = etherscanBaseUrl + transaction.hash;
	} catch (error) {
		if(error.error.message){
			$ahref.innerHTML = 'Error: ' + error.error.message;
		} else {
			$ahref.innerHTML = 'Error: ' + error.data.message;
		}
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function performMintAmountNft() {
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	const amount = $inpAmountMint.value;
	const valueInWei = await contractWithSigner.getPrice();
	try {
		let transaction = await contractWithSigner.multiMint({
			amount: amount,
			value: valueInWei * amount,
		});
		
		$ahref.innerHTML = 'View Etherscan: ' + etherscanBaseUrl + transaction.hash;
		$ahref.href = etherscanBaseUrl + transaction.hash;
	} catch (error) {
		console.log(error);
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function getNftByAddress(address) {
	const baseUri = await ethContract.baseUri();

	try {
		const tokenIDs = await ethContract.getTokenIdsByAddress(address);
		tokenIDs.forEach((tokenID) => {
			fetchData(baseUri + tokenID + '.json', tokenID);
		});
	} catch (error) {
		$ahref.innerHTML = 'Error: ' + error.error.message;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function changeAddressReceive(address) {
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	try {
		let transaction = await contractWithSigner.changeAddressReceiver($inpReceipient.value);
		
		$ahref.innerHTML = 'Success: Change Address Receiver';
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	} catch (error) {
		$ahref.innerHTML = 'Error: ' + error.error.message;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function addWhitelist(address) {
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	try {
		let addresses = []
		addresses.push(address);
		let transaction = await contractWithSigner.addToWhitelist(addresses);
		
		$ahref.innerHTML = 'Success: Add Whitelist';
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	} catch (error) {
		$ahref.innerHTML = 'Error: ' + error.error.message;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function removeWhitelist(address) {
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	try {
		let addresses = []
		addresses.push(address);
		let transaction = await contractWithSigner.removeFromWhitelist(addresses);
		
		$ahref.innerHTML = 'Success: Add Whitelist';
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	} catch (error) {
		$ahref.innerHTML = 'Error: ' + error.error.message;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function getMaxSupply() {
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	try {
		let transaction = await contractWithSigner.totalSupply();
		
		$ahref.innerHTML = 'Success: max supply ' + transaction;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	} catch (error) {
		$ahref.innerHTML = 'Error: ' + error.error.message;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function getPrice() {
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	try {
		let transaction = await contractWithSigner.getPrice();
		
		$ahref.innerHTML = 'Success: price ' + transaction + ' WEI';
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	} catch (error) {
		$ahref.innerHTML = 'Error: ' + error.error.message;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function getPriceWhitelist() {
	console.log(true);
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	try {
		let transaction = await contractWithSigner.getPriceWhitelist();
		
		$ahref.innerHTML = 'Success: price ' + transaction + ' WEI';
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	} catch (error) {
		$ahref.innerHTML = 'Error: ' + error.error.message;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function holdMint() {
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	try {
		let transaction = await contractWithSigner.holdMint();

		$btnSetUnhold.style.display = 'block';
		$btnSetHold.style.display = 'none';
	} catch (error) {
		$ahref.innerHTML = 'Error: ' + error.message;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

async function allowMint() {
	const metamaskSigner = metamaskProvider.getSigner();
	const contractWithSigner = ethContract.connect(metamaskSigner);

	try {
		let transaction = await contractWithSigner.allowMint();

		$btnSetUnhold.style.display = 'block';
		$btnSetHold.style.display = 'none';
	} catch (error) {
		$ahref.innerHTML = 'Error: ' + error.message;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	}
}

function fetchData(fullUri , tokenID){
	const headers = new Headers();
	headers.append('Content-Type', 'application/json');
	headers.append('Accept', 'application/json');
	headers.append('Access-Control-Allow-Origin','*');

	$listNft.innerHTML = '';

	fetch(fullUri, {
		method: 'GET',
		headers: headers,
	}).then(response => {
		return response.json();
	}).then(data => {
		var wrapElement = document.createElement("div");
		wrapElement.style.display = "inline-block";

		var textElement = document.createElement("div");
		textElement.textContent = '#' + (tokenID < 10 ? '0' + tokenID : tokenID);
		textElement.style.textAlign = "center";
		textElement.style.fontWeight = "bold";

		var imgElement = document.createElement("img");
		imgElement.src = data.image;
		imgElement.width = 150;
		imgElement.alt = data.description;

		wrapElement.appendChild(imgElement);
		wrapElement.appendChild(textElement);
		$listNft.appendChild(wrapElement);
	}).catch(error => {
		$ahref.innerHTML = 'Error: ' + error.message + ' - ' + 'Token ID: ' + tokenID;
		setTimeout(function() {
			$ahref.innerHTML = '';
		}, 5000);
	});
}

window.onload = function() {
  connectWithMetamask();
  connectWithContract();
};

$btnMint.addEventListener('click', function() {
	performMintNft();
});

$btnAmountMint.addEventListener('click', function() {
	performMintAmountNft();
});

$btnChangeRecipient.addEventListener('click', function() {
	changeAddressReceive($inpReceipient.value);
});

$btnAddWhitelist.addEventListener('click', function() {
	addWhitelist($inpAddWhitelist.value);
});

$btnRemoveWhitelist.addEventListener('click', function() {
	removeWhitelist($inpRemoveWhitelist.value);
});

$btnGetMaxSupply.addEventListener('click', function() {
	getMaxSupply();
});

$btnGetPrice.addEventListener('click', function() {
	getPrice();
});

$btnGetPriceWhitelist.addEventListener('click', function() {
	getPriceWhitelist();
});

$btnSetHold.addEventListener('click', function() {
	holdMint();
});

$btnSetUnhold.addEventListener('click', function() {
	allowMint();
});

$btnGetNft.addEventListener('click', function() {
  getNftByAddress($inpAddress.value);
});

</script>
</body>
</html>